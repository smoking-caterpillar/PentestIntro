# Proxy / Pivoting

Network pivoting is a technique used by penetration testers to expand the scope of a pentest from a single compromised host to other systems within a network. This technique is useful for identifying and exploiting vulnerabilities in interconnected systems and for gaining access to sensitive data.

A common method for network pivoting is to set up a SOCKS proxy or an HTTP proxy on a compromised host. This allows you to route traffic through the compromised host, effectively allowing you to pivot from one network to another. This technique can be useful for bypassing network restrictions and for gaining access to systems that would otherwise be inaccessible.

## SOCKS proxy
To set up a SOCKS proxy, you will first need to gain access to a compromised host within the target network. From there, you can install a SOCKS proxy server on the host, such as SSH or dante-server. Once the SOCKS proxy server is installed, you can configure your local machine to use the SOCKS proxy, allowing you to route traffic through the compromised host.

In addition to using a dedicated SOCKS proxy server or HTTP proxy server, another option for network pivoting is to configure the Secure Shell (SSH) daemon (sshd) on a compromised host to act as a SOCKS proxy server. This is because SSH provides a secure channel for forwarding traffic between networks, making it an ideal tool for network pivoting.

To configure sshd as a SOCKS proxy server, you will first need to log into the compromised host and modify the sshd configuration file (usually located at /etc/ssh/sshd_config). In the configuration file, you need to add the following line:
```
AllowTcpForwarding yes
```
This line enables TCP forwarding, which is necessary for using ssh as a SOCKS proxy. Next, you will need to restart the ssh service for the changes to take effect. The exact command to do this will depend on your operating system, but for example, on Ubuntu-based systems, you can use the following command:
```
sudo service ssh restart
```
Once you have configured sshd as a SOCKS proxy server, you can use it to pivot from one network to another by creating a secure shell connection from your local machine to the compromised host. You can do this using the following command:
```
ssh -D [port number] [username]@[hostname or IP address]
```
Where [port number] is the local port number you want to use for the SOCKS proxy, [username] is the username you use to log into the compromised host, and [hostname or IP address] is the hostname or IP address of the compromised host.

For example:
```
ssh -D 1080 student@10.0.0.5
```
Once you have established the ssh connection, you can configure your local machine to use the SOCKS proxy by specifying the IP address of your local machine (127.0.0.1) and the port number you specified when creating the ssh connection (1080 in this example).

## HTTP Proxy
To set up an HTTP proxy, the process is similar to setting up a SOCKS proxy. You will need to gain access to a compromised host within the target network and install an HTTP proxy server on the host, such as Squid or Burp Suite. Once the HTTP proxy server is installed, you can configure your local machine to use the HTTP proxy, allowing you to route traffic through the compromised host.

Once you have set up a SOCKS proxy or an HTTP proxy, you can use various tools and techniques to pivot from one network to another. For example, you can use the "proxychains" tool to route traffic from your local machine through the compromised host and into the target network. You can also use tools such as "nmap" to scan the target network and identify other systems that are vulnerable to exploitation.

In conclusion, network pivoting is a powerful technique that allows you to expand the scope of a pentest and to gain access to sensitive data and systems. By setting up a SOCKS proxy or an HTTP proxy on a compromised host, you can effectively pivot from one network to another, allowing you to identify and exploit vulnerabilities in interconnected systems. This technique is a valuable tool for penetration testers and is widely used by security professionals.

